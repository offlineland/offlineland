<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Offlineland</title>
        <link href="/_code/output.css" rel="stylesheet" />
        <link href="/_code/libs/toastify.css" rel="stylesheet" />
    </head>
    <body>
        <script type="module">
            import Toastify from "/_code/libs/toastify-es.js"
            const TOAST_SETTINGS = { duration: 5000, position: "right" };
            const toastError =   (msg) => Toastify({ ...TOAST_SETTINGS, style: { background: "linear-gradient(to right, #e46161, #d32424)" }, text: msg }).showToast();
            const toastSuccess = (msg) => Toastify({ ...TOAST_SETTINGS, style: { background: "linear-gradient(to right, #00b09b, #96c93d)" }, text: msg }).showToast();

            document.addEventListener("DOMContentLoaded", async () => {
                const cb = document.getElementById("codeBlock_full");

                const res = await fetch("/_code/exporter.js");
                const text = await res.text();

                cb.textContent = text;
            })


            function copyToClipboard(elementId) {
                const cb = document.getElementById(elementId);
                const text = cb.innerText;
                navigator.clipboard.writeText(text).then(() => {
                    toastSuccess('Copied to clipboard!');
                }).catch(err => {
                    console.error('Error in copying text: ', err);
                    toastError('Error in copying text')
                });
            }

            window.copyToClipboard = copyToClipboard;
        </script>

        <main class="">
            <div class="text-center p-3 pb-6">
                <h1 class="text-4xl font-bold p-3">Offlineland exporter</h1>
                <p>
                    Code snippet to generate a .zip of most of your stuff that you can then import back on <a href="offlineland.io" class="text-blue-500 hover:text-blue-700 underline">offlineland.io/</a>
                </p>
            </div>

            <div class="p-3 m-3">
                <p>
                    It <b className="text-bold">does not work on steam</b>, coming soon i guess
                </p>
                <p>
                    It archives:
                    <ul class="px-6 list-disc">
                        <li>Your profile</li>
                        <li>Creations</li>
                        <li>Collections</li>
                        <li>Snapshots</li>
                        <li>Mifts</li>
                        <li>The list of areas you're editor in, with links to Cow's <a href="https://areabackup.com" class="text-blue-500 hover:text-blue-700 underline" target="_blank">areabackup.com</a></li>
                    </ul>
                </p>
            </div>

            <div class="p-3 m-3">
                Instructions:
                <ul class="px-6 list-disc">
                    <li class="">Click "Copy to Clipboard" below</li>
                    <li class="">Make sure you're logged in on manyland</li>
                    <li class="">Go to <a href="https://manyland.com/info-rift" class="text-blue-500 hover:text-blue-700 underline" target="_blank">https://manyland.com/info-rift</a></li>
                    <li class="">Open the console by pressing F12</li>
                    <li class="">Paste the snippet (if that's the first time you're doing this, it'll ask you to type something in first)</li>
                    <li class="">Press Enter</li>
                    <li class="">Toggle what you want to archive, click the button, and wait. The zip should download automatically.</li>
                </ul>
            </div>

            <div class="flex flex-col space-y-2 p-4">
                <button onclick="copyToClipboard('codeBlock')" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">
                    Copy to Clipboard
                </button>
                <pre id="codeBlock" class="p-4 bg-gray-100 rounded-md overflow-auto">fetch("https://offlineland.io/_code/exporter.js").then(res => res.text()).then(txt => eval(txt));</pre>
            </div>


            <div class="p-3 m-3">
                <p>
                    Notes:
                    <ul class="px-6 list-disc">
                        <li>Data is saved locally between runs. You can re-run the archiver at any point and it'll pick back up where it left off.</li>
                        <li>Downloading collected creations will take a little while.</li>
                        <li>As usual, you shouldn't run code from sources you do not trust, yadda yadda</li>
                    </ul>
                </p>
            </div>



            <div class="flex flex-col space-y-2 p-4">
                If you're curious, here's the full code:
                <details>
                    <summary class="cursor-pointer">Show</summary>
                    <div class="flex flex-col space-y-2 p-4">
                        <button onclick="copyToClipboard('codeBlock_full')" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">
                            Copy full code to Clipboard
                        </button>
                        <pre id="codeBlock_full" class="p-4 bg-gray-100 rounded-md overflow-auto"></pre>
                    </div>
                </details>
            </div>

        </main>
    </body>
</html>
